---
layout: post
title: react入门
date:  2021-10-11
categories: 前端
tags: [前端开发,react]
---

## react项目构建
webpack
`npx create-react-app my-app`
vite
`yarn create @vitejs/app my-app` 
`npm init @vitejs/app my-vue-app` 

## react
state
```
this.state
setState()
```

props==vue prop
```
this.prop.ParentAttributes
```

hook
必须在最外层函数(组件)使用
```
state hook
const [state, setState] =useState(初始值) 

effect hook
useEffect(){
  
} 

自定义hook
可以使用其他hook
useMyEffect(){
  
} 
```


## redux(~=vuex)
（1）Web 应用是一个状态机，视图与状态是一一对应的。
（2）所有的状态，保存在一个对象里面。
创建redux中心
```
import { createStore } from 'redux';
const store = createStore(fn)
```
state
```
import { createStore } from 'redux';
const store = createStore(fn)
store.getStore();
store.createStore(reducer);
```
action
```
import { createStore } from 'redux';
const store = createStore(fn)
const action = {
  type: 'action_name',
  payload: '携带信息'
};
//生成多个action
function create_action(){
    return {
  type: 'action_name',
  payload: '携带信息'
};
}
const action = addTodo();
```
dispatch
```
import { createStore } from 'redux';
const store = createStore(fn);
//接收一个action
store.dispatch({
  type: 'ADD_TODO',
  payload: 'Learn Redux'
});
```
Reducer
```
const reducer = function (state, action) {
  // ...
  return new_state;
};
```
subscribe
store.subscribe方法返回一个函数，调用这个函数就可以解除监听
```
import { createStore } from 'redux';
const store = createStore(reducer);

store.subscribe(listener);
```
多个reducer合并
```
import { combineReducers } from 'redux';

const reducer = combineReducers({
  a: doSomethingWithA,
  b: processB,
  c: c
})

// 等同于
function reducer(state = {}, action) {
  return {
    a: doSomethingWithA(state.a, action),
    b: processB(state.b, action),
    c: c(state.c, action)
  }
}
```
中间件dispatch添加功能
```
const store = createStore(
  reducer,
  //applyMiddlewares将所有中间件放入一个数组，依次执行
  applyMiddleware(thunk, promise, logger)
);
```
异步操作
同步操作只要发出一种 Action 即可，异步操作的差别是它要发出三种 Action
```
// 写法一：名称相同，参数不同
{ type: 'FETCH_POSTS' }
{ type: 'FETCH_POSTS', status: 'error', error: 'Oops' }
{ type: 'FETCH_POSTS', status: 'success', response: { ... } }

// 写法二：名称不同
{ type: 'FETCH_POSTS_REQUEST' }
{ type: 'FETCH_POSTS_FAILURE', error: 'Oops' }
{ type: 'FETCH_POSTS_SUCCESS', response: { ... } }
```



## react-router-dom
`npm install react-router-dom --save-dev`

```
export default class Home extends React.Component {
    render() {
        return (
            <div>
                <a>去detail</a>
                <a href='#/detail'>去detail</a>
            </div>
        )
    }
}

export default class Home extends React.Component {
    render() {
        return (
            <div>
                <a>回到home</a>
                <a href='#/'>回到home</a>           
            </div>
        )
    }
}

import {HashRouter,historyRouter, Route, Switch} from 'react-router-dom';
const BasicRoute = () => (
    <HashRouter>
        <Switch>
            <Route exact path="/" component={Home}/>
            <Route exact path="/detail" component={Detail}/>
        </Switch>
    </HashRouter>
);
```
函数式跳转
```
    render() {
        return (
            <div>
                <a href='#/detail'>去detail</a>
                <button onClick={() => this.props.history.push({
                        pathname: '/detail',
                        state: {
                            id: 3
                        }
                })}>通过函数跳转
                </button>
                <button onClick={() => this.props.history.push('detail')}>通过函数跳转</button>
            </div>
        )
    }

import {HashRouter, Route, Switch,hashHistory} from 'react-router-dom';
const BasicRoute = () => (
    <HashRouter history={hashHistory}>
        <Switch>
            <Route exact path="/" component={Home}/>
            //路由传参
            <Route exact path="/detail/:id" component={Detail}/>
            <Route exact path="/detail" component={Detail}/>
        </Switch>
    </HashRouter>
);

获取参数
this.props.match.params
this.props.history.location.state
```
